Part 1. Установка ОС
cat /etc/issue # узнать версию Ubuntu

Part 2. Создание пользователя
useradd -m user1 # добавить нового пользователя
cat /etc/passwd # просмотреть, что пользователь добавлен
sudo passwd user1 # установить пароль для user1
su user1 # сменить пользователя на user1
exit # выйти из пользователя
sudo usermod -aG adm user1 # добавить user1 в группу администратора, так он может просматривать файлы в /var/log
ls -l /var/log # проверка прав в папке /var/log
sudo userdel -r user1 # удалить пользователя



hostnamectl # посмотреть информацию о хосте, hostname - и есть машина или сервер

Part 3. Настройка сети ОС
Для изменения имени сервера нужно изменить его в 2х файлах:
sudo nano /etc/hosts
sudo nano /etc/hostname

sudo cp /etc/localtime /etc/localtime.bak # создать резервную копию текущего часового пояса
sudo ln -sf /usr/share/zoneinfo/Europe/Moscow /etc/localtime # меняет время в Linux на указанный пояс Europe/Moscow
ls usr/share/zoneinfo # посмотреть все часовые пояса
date # проверить свой часовой пояс

внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw - gateway - роутер).
ifconfig # выведет названия сетевых интерфейсов enp0s3 и lo, а также ip, subnetmask
или
ip addr
# интерфейс lo (loopback - локальная петля)
нужен для того, чтобы компьютер даже при отсутствии сетевых интерфейсов мог обращаться к самому себе по IP 127.0.0.1
route # посмотреть информацию по gateway роутера

# DHCP (Dynamic Host Configuration Protocol)
Протокол DHCP является клиент-серверным, то есть в его работе участвуют клиент DHCP и сервер DHCP.
Передача данных производится при помощи протокола UDP. По умолчанию запросы от клиента делаются к серверу на порт 67,
сервер в свою очередь отвечает клиенту на порт 68, выдавая адрес IP и другую необходимую информацию, такую, как сетевую маску,
маршрутизатор и серверы DNS.

DHCP (англ. Dynamic Host Configuration Protocol — протокол динамической настройки узла) — прикладной протокол,
позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети TCP/IP.
Данный протокол работает по модели «клиент-сервер». Для автоматической конфигурации компьютер-клиент на этапе конфигурации сетевого устройства
обращается к так называемому серверу DHCP и получает от него нужные параметры.
Сетевой администратор может задать диапазон адресов, распределяемых сервером среди компьютеров.
Это позволяет избежать ручной настройки компьютеров сети и уменьшает количество ошибок.
Протокол DHCP используется в большинстве сетей TCP/IP.

sudo nano /etc/netplan/00-installer-config.yaml # внесение статичных настроек ip, gw, dns (обязательно с соблюдением пробелов)
dhcp4 - если оставить true, то ip-адреса будут выдаваться автоматически

# This is the network config written by 'subiquitu'

network:
  renderer: NetworkManager
  ethernets:
    enp0s3:
      addresses: [192.168.0.119/24]
      gateway: 192.168.0.1
      nameservers:
        addresses: [1.1.1.1, 8.8.8.8]
      routes:
       - to: default
         via: 192.168.0.1
       dhcp4: false
   version: 2
    
Далее сохранить эти настройки перезапустить sudo reboot now и проверить через ping yandex.com, есть ли подключение к сети

Part 4. Обновление ОС
sudo apt update # вычисляет, сколько пакетов может быть обновлено
sudo apt full-upgrade # установка всех обновлений
sudo do-release-upgrade # обновление системы до новой версии (если она есть)

Part 5. Использование команды sudo
sudo позволяет выполнять команды от имени root
sudo su # зайти под root-ом, чтобы не нужно было в командах прописывать sudo, но тут все же напишу с ними

Для изменения имени сервера, надо изменить это имя в 2х файлах:
    /etc/hosts
    /etc/hostname

sudo usermod -aG adm user1 # добавляем user1 в группу adm

ls -l /etc/hosts # проверить права в файле
ls -l /etc/hostname # проверить права в файле

sudo chmod g+w /etc/hosts # дать права на запись для группы adm
sudo chmod g+w /etc/hostname # дать права на запись для группы adm

sudo nano /etc/hosts # изменить имя сервера
sudo nano /etc/hostname # изменить имя сервера

sudo reboot now # перезагрузка, после этого имя сервера изменилось

Part 6. Установка и настройка службы времени
timedatectl show # команда выдает информацию о настройках времени

Part 7. Установка и использование текстовых редакторов
sudo apt install joe # установка редактора joe
sudo apt install mc # установка редактора mcedit
sudo apt install vim # установка редактора vim

joe: Ctrl+K - сохранить, а затем клавишу Q - для выхода
mcedit: Ecs, далее в меню выбрать сохранить или нет
vim: i - перейти в режим печати, Esc - выйти из режима печати, :wq - выйти с сохранением изменений, :q! - выйти без сохранения изменений

grep user ./* - поиск слова user в текущей дериктории, на выводе строки, содержащие данное слово, из всех файлов
grep user ./* | sed 's/user/friend/g' - в выводе заменит слово user на слово friend, при этом файлы НЕ изменятся
grep user ./* | sed 's/user/friend/gw ./*' - в выводе заменит слово user на слово friend, при этом файлы изменятся

Part 8. Установка и базовая настройка сервиса SSHD
sudo apt-get install openssh-server # установить ssh
sudo systemctl enable sshd # добавить в автозагрузку, чтобы служба запускалась автоматически
sudo systemctl disable sshd # удалить из автозагрузки

Если после удаления из автозагрузки снова попытаться добавить командой:
sudo systemctl enable sshd
выдаст ошибку Unit file sshd.service does not exist
поэтому надо обратиться по имени:
sudo systemctl enable ssh
после этого можно по команде ssh подключаться к удаленному серверу:
ssh 127.0.0.1 или ssh -l user1 127.0.0.1 или ssh user1@127.0.0.1
exit для прекращения сеанса

service ssh status # проверить активен ли сервис и слушает ли порт 22
service ssh start # сделать сервис активным

Изменение порта SSH:
sudo nano /etc/ssh/sshd_config
в файле нужно раскомментировать строку #Port 22 и заменить порт на другой, сохранить файл
в консоли перезапустить cbcntve: systemctl restart sshd
проверяем статус: service sshd status
netstat -tulpn # проверяет статус портов на прием и передачу, то есть порт (код, который ранее внесли) должен быть в 2х строках
sudo ufw status # проверяем статус firewall (если inactive, то команда sudo ufw enable)
sudo ufw allow 2022 # открываем доступ по порту 2022 (2022 - это пример, вносится тот же код, на который меняли порт 22)
после этого порты появятся в статусе (sudo ufw status)
перезапустим firewall: ufw reload
netstat -tan

Part 9. Установка и использование утилит top, htop
top # диспетчер задач
пробел - обновить список процессов

первая строка показывает то же самое, что выводит команда uptime
us - количество авторизованных пользователей
load average - общая загрузка системы (за 1, 5 и 15 минут)
Если 1 процессор, то максимальное значение 1 (т.е. 100%), если 4 процессора, то максимальное значение 4 (т.е. 400%)
tasks - общее количество процессов
%CPU(s) - загрузку cpu (сколько процессоров загружено пользователем - us, сколько системой - sy)
MiB Mem - загрузку памяти

d - чтобы ввести задержку обновления

NI (Nice) - показатель, отвечающий за приоритетность процесса (19 - самый низкий приоритет, -20 - высокий)
PR - приоритет (0 - самый приоритетный)
r - чтобы изменить показатель nice, а соответственно и приоритет
После нажатия вводим PID процесса для изменения > Enter > число, на которое хотим изменить
Приоритет меняется автоматически

k (kill) - убить процесс, вводим PID процесса (если ввести 9, то убивает без ожидания завершения процесса, если 15, то ожидает завершения процесса)

shift + p # сортировка по колонке cpu (загрузка процессора)
shift + m # сортировка по колонке mem (загрузка памяти)

htop #
выбрать, по чему сортировать shift + < и далее клавишами вверх-вниз и выбираем



















